# protocol


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

## Request and Response Types

These enums define the message types used for communication between the
parent process and worker processes. The parent sends requests and the
worker responds with various response types.

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-workers/blob/main/cjm_fasthtml_workers/core/protocol.py#L15"
target="_blank" style="float:right; font-size:smaller">source</a>

### WorkerRequestType

>  WorkerRequestType (value, names=None, module=None, qualname=None,
>                         type=None, start=1, boundary=None)

*Types of requests sent to worker process.*

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-workers/blob/main/cjm_fasthtml_workers/core/protocol.py#L25"
target="_blank" style="float:right; font-size:smaller">source</a>

### WorkerResponseType

>  WorkerResponseType (value, names=None, module=None, qualname=None,
>                          type=None, start=1, boundary=None)

*Types of responses from worker process.*

## Data Structures

These dataclasses define the structure of messages passed through
multiprocessing queues. They provide `to_dict()` and `from_dict()`
methods for serialization since objects passed through queues need to be
picklable.

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-workers/blob/main/cjm_fasthtml_workers/core/protocol.py#L36"
target="_blank" style="float:right; font-size:smaller">source</a>

### WorkerRequest

>  WorkerRequest (type:__main__.WorkerRequestType, data:Dict[str,Any])

*Base structure for worker requests.*

``` python
# Test WorkerRequest serialization
request = WorkerRequest(
    type=WorkerRequestType.EXECUTE,
    data={'job_id': 'test-123', 'plugin_name': 'test_plugin', 'param1': 'value1'}
)
request
```

    WorkerRequest(type=<WorkerRequestType.EXECUTE: 'execute'>, data={'job_id': 'test-123', 'plugin_name': 'test_plugin', 'param1': 'value1'})

``` python
# Test to_dict conversion
request_dict = request.to_dict()
request_dict
```

    {'type': 'execute',
     'job_id': 'test-123',
     'plugin_name': 'test_plugin',
     'param1': 'value1'}

``` python
# Test from_dict deserialization
restored_request = WorkerRequest.from_dict(request_dict)
restored_request
```

    WorkerRequest(type=<WorkerRequestType.EXECUTE: 'execute'>, data={'job_id': 'test-123', 'plugin_name': 'test_plugin', 'param1': 'value1'})

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-workers/blob/main/cjm_fasthtml_workers/core/protocol.py#L57"
target="_blank" style="float:right; font-size:smaller">source</a>

### WorkerResponse

>  WorkerResponse (type:__main__.WorkerResponseType, data:Dict[str,Any])

*Base structure for worker responses.*

``` python
# Test WorkerResponse
response = WorkerResponse(
    type=WorkerResponseType.RESULT,
    data={'job_id': 'test-123', 'status': 'success', 'data': {'output': 'result'}}
)
response_dict = response.to_dict()
response_dict
```

    {'type': 'result',
     'job_id': 'test-123',
     'status': 'success',
     'data': {'output': 'result'}}

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-workers/blob/main/cjm_fasthtml_workers/core/protocol.py#L78"
target="_blank" style="float:right; font-size:smaller">source</a>

### WorkerStreamChunk

>  WorkerStreamChunk (job_id:str, chunk:str, is_final:bool=False,
>                         metadata:Optional[Dict[str,Any]]=None)

*Structure for streaming job results.*

``` python
# Test WorkerStreamChunk
chunk = WorkerStreamChunk(
    job_id='test-456',
    chunk='This is a streaming chunk',
    is_final=False,
    metadata={'index': 1}
)
chunk.to_dict()
```

    {'type': 'stream_chunk',
     'job_id': 'test-456',
     'chunk': 'This is a streaming chunk',
     'is_final': False,
     'metadata': {'index': 1}}

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-workers/blob/main/cjm_fasthtml_workers/core/protocol.py#L97"
target="_blank" style="float:right; font-size:smaller">source</a>

### WorkerResult

>  WorkerResult (job_id:str, status:str, data:Optional[Dict[str,Any]]=None,
>                    error:Optional[str]=None)

*Structure for job execution results.*

``` python
# Test WorkerResult - success case
result = WorkerResult(
    job_id='test-789',
    status='success',
    data={'text': 'Job completed successfully', 'metadata': {'time': 1.5}}
)
result.to_dict()
```

    {'type': 'result',
     'job_id': 'test-789',
     'status': 'success',
     'data': {'text': 'Job completed successfully', 'metadata': {'time': 1.5}}}

``` python
# Test WorkerResult - error case
error_result = WorkerResult(
    job_id='test-999',
    status='error',
    error='Plugin execution failed: Invalid input'
)
error_result.to_dict()
```

    {'type': 'result',
     'job_id': 'test-999',
     'status': 'error',
     'error': 'Plugin execution failed: Invalid input'}

## Plugin Manager Protocol

The
[`PluginManagerAdapter`](https://cj-mills.github.io/cjm-fasthtml-workers/core/protocol.html#pluginmanageradapter)
is a Protocol class that uses structural subtyping (duck typing). Any
class that implements these methods will satisfy the protocol, even
without explicit inheritance.

This protocol defines the interface that plugin managers must implement
to work with the worker system. It handles: - Plugin discovery and
loading - Plugin execution (both standard and streaming) - Plugin
lifecycle management (reload/unload) - Streaming capability detection

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-workers/blob/main/cjm_fasthtml_workers/core/protocol.py#L118"
target="_blank" style="float:right; font-size:smaller">source</a>

### PluginManagerAdapter

>  PluginManagerAdapter (*args, **kwargs)

\*Protocol that plugin managers must satisfy for worker integration.

Uses structural subtyping (duck typing) - plugin managers donâ€™t need to
explicitly inherit from this, they just need to implement these
methods.\*
